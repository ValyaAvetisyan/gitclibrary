<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:include="fragment/header::head(title='Request page')">
</head>
<body>
<div class="container">
    <nav th:replace="fragment/menu::menu"></nav>

    <div class="panel panel-default">

        <div class="panel-body">
            <form method="POST" th:action="@{/admin/addBook}" th:object="${bookCmd}">
                <input type="hidden" th:field="*{id}"/>

                <div class="row">
                    <div class="col-lg-2 form-group">
                        <label th:text="#{common.title}"></label>
                    </div>
                    <div class="col-lg-10 form-group">
                        <input type="text" class="form-control" th:field="*{title}"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-2 form-group">
                        <label th:text="#{common.description}"> </label>
                    </div>
                    <div class="col-lg-10 form-group">
                        <textarea rows="4" class="form-control" th:field="*{desc}"></textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-2 form-group">
                        <label th:text="#{common.category}"></label>
                    </div>
                    <div class="col-lg-10 form-group">
                        <select class="form-control" th:field="*{category.id}">
                            <option th:each="c : ${categories}" th:value="${c.id}" th:text="${c.name}">
                            </option>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-2 form-group">
                        <label th:text="#{common.price}"></label>
                    </div>
                    <div class="col-lg-10 form-group" th:classappend="${#fields.hasErrors('price')}? has-error">
                        <input type="number" pattern="[0-9]+([\.,][0-9]+)?" step="0.01"
                               class="form-control" th:field="*{price}"/>
                        <p th:if="${#fields.hasErrors('price')}" th:text="'Incorrect price value'"></p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-2 form-group">
                        <label th:text="#{common.minLength}"></label>
                    </div>
                    <div class="col-lg-10 form-group">
                        <input type="number" class="form-control" pattern="[0-9]+"
                               th:field="*{minLength}"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-2 form-group">
                        <label th:text="#{common.maxLength}"></label>
                    </div>
                    <div class="col-lg-10 form-group">
                        <input type="number" class="form-control" pattern="[0-9]+"
                               th:field="*{maxLength}"/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-2 form-group">
                        <label th:text="#{common.quality}"></label>
                    </div>

                    <div class="col-lg-10 form-group">
                        <select class="form-control" id="quality" name="quality" th:field="*{quality}">
                            <option
                                    th:each="qual : ${quality}"
                                    th:value="${qual}"
                                    th:text="${qual}">
                            </option>
                        </select>
                    </div>

                </div>
                <div class="row">
                    <div class="col-lg-2 form-group">
                        <label th:text="#{common.expirationDate}"></label>
                    </div>
                    <div class="col-lg-10 form-group">
                        <input type="date" class="form-control" th:field="*{expirationDate}"/>
                    </div>
                </div>
                <div class="row" th:if="${#httpServletRequest.getAttribute('isEdit') == true}">
                    <div class="col-lg-2 form-group">
                        <label th:text="#{common.isClosed}">Is Closed: </label>
                    </div>
                    <div class="col-sm-1 form-group">
                        <input type="checkbox" name="isClosed" th:checked="*{isClosed}"/>
                    </div>
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-primary" th:text="#{common.saveChanges}"></button>
                    <button th:if="${#httpServletRequest.getAttribute('isEdit') == true}" type="button"
                            class="btn btn-danger pull-right" data-target="#chooseDialog"
                            th:text="#{common.delete}"
                            data-toggle="modal">
                    </button>
                </div>
            </form>

        </div>
    </div>
</div>
<!-- Modal -->
<div class="modal fade" id="chooseDialog" role="dialog"
     th:if="${#httpServletRequest.getAttribute('isEdit') == true}">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title" th:text="#{common.attention}"></h4>
            </div>
            <div class="modal-body">
                <p th:text="#{buyer.deleteRequestQuestion}"></p>
            </div>

            <div class="modal-footer">
                <button type="submit" class="btn btn-default" data-dismiss="modal" id="delete_button"
                        th:text="#{common.delete}"></button>
                <button type="button" class="btn btn-default" data-dismiss="modal" th:text="#{common.cancel}"></button>
            </div>
        </div>
    </div>
</div>

<script th:inline="javascript">
    $(document).on("click", "#delete_button", function (event) {
        var path = [[@{/videoRequest/delete}]];
        document.location.href = path;
    });
</script>
</body>
</html>